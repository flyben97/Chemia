# åŸå§‹æ•°æ®åˆ†å‰²ä¿å­˜åŠŸèƒ½ (Original Data Splits Feature)

## åŠŸèƒ½æ¦‚è¿°

è¿™ä¸ªæ–°åŠŸèƒ½ä¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨ä¿å­˜åŸå§‹æ•°æ®çš„åˆ†å‰²ç‰ˆæœ¬ï¼Œè®©æ‚¨å¯ä»¥è½»æ¾æ£€æŸ¥å“ªäº›æ•°æ®è¢«ç”¨äºè®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ” **æ˜“äºæ£€æŸ¥**: å°†åŸå§‹æ•°æ®æŒ‰ç…§è®­ç»ƒæ—¶çš„ç›¸åŒåˆ†å‰²æ–¹å¼ä¿å­˜ä¸ºå•ç‹¬çš„CSVæ–‡ä»¶
- ğŸ“Š **å®Œæ•´ä¿¡æ¯**: ä¿ç•™åŸå§‹æ•°æ®çš„æ‰€æœ‰åˆ—ï¼ŒåŒ…æ‹¬SMILESã€ç›®æ ‡å€¼å’Œå…¶ä»–ç‰¹å¾
- ğŸ“ˆ **åˆ†å‰²ç»Ÿè®¡**: è‡ªåŠ¨ç”Ÿæˆåˆ†å‰²æ‘˜è¦ï¼Œæ˜¾ç¤ºæ¯ä¸ªæ•°æ®é›†çš„å¤§å°å’Œç™¾åˆ†æ¯”
- ğŸ”„ **ä¸€è‡´æ€§**: ç¡®ä¿ä¸æ¨¡å‹è®­ç»ƒä½¿ç”¨çš„æ˜¯å®Œå…¨ç›¸åŒçš„æ•°æ®åˆ†å‰²

## è¾“å‡ºæ–‡ä»¶ç»“æ„

è¿è¡Œè®­ç»ƒåï¼Œæ‚¨ä¼šåœ¨è¾“å‡ºç›®å½•ä¸­æ‰¾åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼š

```
output/your_experiment_name/
â”œâ”€â”€ models/                     # è®­ç»ƒçš„æ¨¡å‹
â”œâ”€â”€ data_splits/               # å¤„ç†åçš„ç‰¹å¾æ•°æ®
â”œâ”€â”€ original_data_splits/      # æ–°å¢ï¼åŸå§‹æ•°æ®åˆ†å‰²
â”‚   â”œâ”€â”€ train_original_data.csv    # è®­ç»ƒé›†åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ test_original_data.csv     # æµ‹è¯•é›†åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ val_original_data.csv      # éªŒè¯é›†åŸå§‹æ•°æ® (å¦‚æœä½¿ç”¨ train_valid_test æ¨¡å¼)
â”‚   â””â”€â”€ data_split_summary.csv     # åˆ†å‰²æ‘˜è¦ç»Ÿè®¡
â””â”€â”€ run_config.json           # è¿è¡Œé…ç½®
```

## æ–‡ä»¶è¯´æ˜

### 1. æ•°æ®åˆ†å‰²æ–‡ä»¶
- **train_original_data.csv**: åŒ…å«ç”¨äºè®­ç»ƒçš„åŸå§‹æ•°æ®è¡Œ
- **test_original_data.csv**: åŒ…å«ç”¨äºæµ‹è¯•çš„åŸå§‹æ•°æ®è¡Œ  
- **val_original_data.csv**: åŒ…å«ç”¨äºéªŒè¯çš„åŸå§‹æ•°æ®è¡Œï¼ˆä»…åœ¨ä½¿ç”¨ `train_valid_test` æ¨¡å¼æ—¶ï¼‰

### 2. åˆ†å‰²æ‘˜è¦æ–‡ä»¶ (data_split_summary.csv)
åŒ…å«ä»¥ä¸‹åˆ—ï¼š
- `split`: æ•°æ®é›†åç§° (train/val/test)
- `count`: æ ·æœ¬æ•°é‡
- `percentage`: å æ€»æ•°æ®çš„ç™¾åˆ†æ¯”

## ä½¿ç”¨ç¤ºä¾‹

### æ–¹æ³•1: ä½¿ç”¨ç°æœ‰é…ç½®

åªéœ€æ­£å¸¸è¿è¡Œæ‚¨çš„è®­ç»ƒé…ç½®ï¼ŒåŠŸèƒ½ä¼šè‡ªåŠ¨æ¿€æ´»ï¼š

```bash
# ä½¿ç”¨ç°æœ‰é…ç½®
python run_training_only.py --config your_config.yaml

# æˆ–ä½¿ç”¨å®Œæ•´å·¥ä½œæµ
python run_full_workflow.py --config config_full_workflow.yaml
```

### æ–¹æ³•2: ä½¿ç”¨ç¤ºä¾‹é…ç½®

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¸“é—¨çš„ç¤ºä¾‹é…ç½®ï¼š

```bash
python run_training_only.py --config examples/configs/config_with_original_splits.yaml
```

### æ–¹æ³•3: è¿è¡Œæ¼”ç¤º

```bash
python demo_original_splits.py
```

## é…ç½®é€‰é¡¹

åŠŸèƒ½æ”¯æŒæ‰€æœ‰ç°æœ‰çš„æ•°æ®åˆ†å‰²æ¨¡å¼ï¼š

### äº¤å‰éªŒè¯æ¨¡å¼ (æ¨èç”¨äºå°æ•°æ®é›†)
```yaml
split_mode: "cross_validation"
split_config:
  cross_validation:
    n_splits: 5
    test_size_for_cv: 0.2
    random_state: 42
```

### ä¼ ç»Ÿåˆ†å‰²æ¨¡å¼
```yaml
split_mode: "train_valid_test"
split_config:
  train_valid_test:
    test_size: 0.2
    valid_size: 0.1
    random_state: 42
```

## å®é™…åº”ç”¨åœºæ™¯

### 1. æ•°æ®è´¨é‡æ£€æŸ¥
æ£€æŸ¥è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ•°æ®åˆ†å¸ƒæ˜¯å¦åˆç†ï¼š
```python
import pandas as pd

# åŠ è½½åˆ†å‰²åçš„æ•°æ®
train_data = pd.read_csv('output/your_run/original_data_splits/train_original_data.csv')
test_data = pd.read_csv('output/your_run/original_data_splits/test_original_data.csv')

# æ£€æŸ¥ç›®æ ‡å€¼åˆ†å¸ƒ
print("è®­ç»ƒé›†eeå€¼åˆ†å¸ƒ:")
print(train_data['ee'].describe())
print("\næµ‹è¯•é›†eeå€¼åˆ†å¸ƒ:")
print(test_data['ee'].describe())
```

### 2. ç‰¹å®šæ ·æœ¬åˆ†æ
æŸ¥æ‰¾ç‰¹å®šçš„ååº”æ¡ä»¶åœ¨å“ªä¸ªæ•°æ®é›†ä¸­ï¼š
```python
# æŸ¥æ‰¾ç‰¹å®šé…ä½“çš„åˆ†å¸ƒ
ligand_of_interest = "your_ligand_smiles"
train_count = len(train_data[train_data['Ligand'] == ligand_of_interest])
test_count = len(test_data[test_data['Ligand'] == ligand_of_interest])
print(f"ç›®æ ‡é…ä½“åœ¨è®­ç»ƒé›†: {train_count} ä¸ª, æµ‹è¯•é›†: {test_count} ä¸ª")
```

### 3. é‡ç°æ€§éªŒè¯
ç¡®ä¿æ¨¡å‹è¯„ä¼°çš„å¯é‡ç°æ€§ï¼š
```python
# ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æµ‹è¯•é›†é‡æ–°è¯„ä¼°æ¨¡å‹
test_smiles = test_data[['Reactant1', 'Reactant2', 'Ligand']].values
true_values = test_data['ee'].values
# ç„¶åä½¿ç”¨è¿™äº›æ•°æ®è¿›è¡Œé¢„æµ‹...
```

## æŠ€æœ¯ç»†èŠ‚

- æ•°æ®åˆ†å‰²åœ¨ç‰¹å¾ç”Ÿæˆ**ä¹‹å‰**è¿›è¡Œï¼Œç¡®ä¿ç´¢å¼•ä¸€è‡´æ€§
- ä½¿ç”¨ä¸æ¨¡å‹è®­ç»ƒç›¸åŒçš„éšæœºç§å­ï¼Œä¿è¯åˆ†å‰²ä¸€è‡´æ€§
- è‡ªåŠ¨å¤„ç†ç¼ºå¤±å€¼æ¸…ç†åçš„ç´¢å¼•æ˜ å°„
- æ”¯æŒæ‰€æœ‰ç°æœ‰çš„æ•°æ®æºæ¨¡å¼å’Œåˆ†å‰²é…ç½®

## æ³¨æ„äº‹é¡¹

1. **å­˜å‚¨ç©ºé—´**: è¿™ä¼šå¢åŠ è¾“å‡ºç›®å½•çš„å¤§å°ï¼Œå› ä¸ºä¿å­˜äº†åŸå§‹æ•°æ®çš„å‰¯æœ¬
2. **å¤§æ•°æ®é›†**: å¯¹äºéå¸¸å¤§çš„æ•°æ®é›†ï¼Œè€ƒè™‘æ˜¯å¦éœ€è¦è¿™ä¸ªåŠŸèƒ½
3. **éšç§æ•°æ®**: ç¡®ä¿åŸå§‹æ•°æ®çš„ä¿å­˜ç¬¦åˆæ‚¨çš„æ•°æ®å®‰å…¨è¦æ±‚

## æ•…éšœæ’é™¤

å¦‚æœå‡ºç°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. **æƒé™**: ç¡®ä¿æœ‰å†™å…¥è¾“å‡ºç›®å½•çš„æƒé™
2. **ç£ç›˜ç©ºé—´**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ä¿å­˜é¢å¤–çš„CSVæ–‡ä»¶
3. **æ•°æ®æ ¼å¼**: ç¡®ä¿åŸå§‹æ•°æ®å¯ä»¥æ­£å¸¸è¯»å–å’Œä¿å­˜ä¸ºCSVæ ¼å¼

## å‘åå…¼å®¹æ€§

æ­¤åŠŸèƒ½å®Œå…¨å‘åå…¼å®¹ï¼Œä¸ä¼šå½±å“ç°æœ‰çš„å·¥ä½œæµç¨‹æˆ–é…ç½®æ–‡ä»¶ã€‚å¦‚æœæ‚¨ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥å¿½ç•¥ç”Ÿæˆçš„ `original_data_splits/` æ–‡ä»¶å¤¹ã€‚ 